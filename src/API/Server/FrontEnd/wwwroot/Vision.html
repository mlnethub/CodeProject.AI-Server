<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta charset="utf-8" />
	<title>CodeProject.AI Explorer</title>

	<!-- If you use this, ensure the body has class "dark-mode"-->
	<link rel="stylesheet" type="text/css" href="assets/bootstrap-dark.min.css">
	<!-- for light mode should you wish it
	   <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" />
	-->
	<!-- Will only be effective if you're connected to the internet -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;400;600&display=swap" rel="stylesheet">

	<link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16x16.png">
	<style>
		.header {
			font-family: Inter, Arial, Helvetica, Arial, sans-serif;
			padding: 10px 0;
			margin-bottom: 25px;
		}

        .nav-link {
			padding:0.5rem 1rem;
        }

        .site-title {
            text-decoration: none !important;
            font-size: 2.7rem;
            display: inline-block;
            text-transform: uppercase;
            vertical-align: middle;
            letter-spacing: -3px;
        }

			.site-title .front {
				font-weight: 200;
			}

			.site-title .end {
				font-weight: 600;
			}

		.timing-table {
			margin-top:1rem;
		}
			.timing-table td {
				font-size: 80%;
				padding-right: 1rem;
			}

		#faces::file-selector-button {
			width: 10rem;
		}

		input[type="range"]::-webkit-slider-thumb {
			margin-top: -7px;
		}


		.dark-mode .header {
			background: rgb(255,153,0);
		}

		.dark-mode .card-body {
			background-color: rgb(108,117,125);
		}

		.dark-mode .site-title {
			color: white;
		}

		.dark-mode .nav-tabs {
			background-color: #4b4b4b;
		}

			.dark-mode .nav-tabs .nav-link.active {
				background-color: #808080;
			}

		.dark-mode input[type=range]::-webkit-slider-runnable-track {
			background-color: lightgray;
			height: 2px;
		}

		.dark-mode input[type="range"] {
			background-color: grey;
		}
	</style>

	<script type="text/javascript">

		const useSVG             = true;
		const pingFrequency      = 5000; // milliseconds
		const serviceTimeoutSec  = 30;   // seconds

        const apiServiceProtocol = window.location.protocol;
        const apiServiceHostname = window.location.hostname || "localhost";
        const apiServicePort     = window.location.port === "" ? "" : ":" + (window.location.port || 32168);
        const apiServiceUrl      = `${apiServiceProtocol}//${apiServiceHostname}${apiServicePort}`;

		let serverOnline = false;

		window.addEventListener('DOMContentLoaded', function (event) {
			serviceUrl.value = apiServiceUrl;
			serviceTimeoutSecTxt.value = serviceTimeoutSec;
			setStatus("Searching for API Server...", "orange");
			setInterval(ping, pingFrequency);
			setInterval(getAnalysisStatus, pingFrequency);
			setTimeout(setCustomModelLists, 5000);

			setInterval(onTrainingStatus, 5000);

			// Quick check for the video demo
			try {
				navigator.getUserMedia({ video: true }, () => {
					console.log('Webcam detected.');
				}, () => {
					console.log('No webcam detected.');
					document.getElementById('video-panel').style.display = 'none';
					document.getElementById('video-tab').style.display = 'none';
				});
				onStopVideo(null);
			}
			catch {
				console.log('Webcam detection failed.');
				document.getElementById('video-panel').style.display = 'none';
				document.getElementById('video-tab').style.display = 'none';
			}
		});

		function adjustForImageSize() {

			if (useSVG) {
				// clearCanvas();
				imageMask.style.height = this.height + 'px';
				imageMask.style.width = this.width + 'px';
			}
			else {
				annotations.height = this.height;
				annotations.width = this.width;
			}

			return true;
		}

		function previewImage(fileChooser) {

			if (fileChooser.files)
				setImage(fileChooser.files[0]);
		}

		function loadVideoFile(fileChooser) {
			// TBD
		}

		function setImage(imageToSet) {

			clearCanvas();
			img.onload = adjustForImageSize;
			img.src = URL.createObjectURL(imageToSet);
			img.style.height = "auto";
			img.style.visibility = "visible";
		}

		function clearCanvas() {
			if (useSVG) {
				imageMask.innerHTML = '';
				img.style.visibility = "hidden";
                img2.style.visibility = "hidden";
			}
			else {
				let context = annotations.getContext("2d");
				context.clearRect(0, 0, annotations.width, annotations.height);
			}
		}

		/**
		Sets the status text (small area top left) to be the error message in red.
		Since this is a small area, the text needs to be short.
		@param message - a short status message
		@param error - a longer error message which, if supplied, will be sent to console
		*/
		function setError(message, error) {
			setStatus(message, "red")
			if (error)
				console.log(message + " Error: " + error);
			else
				console.log(message);
		}

		/**
		Sets the status text (small area top left) to be the message in the given colour.
		Since this is a small area, the text needs to be short.
		*/
		function setStatus(text, color) {
			if (color)
				document.getElementById("status").innerHTML = "<span style='color:" + color + "'>" + text + "</span>";
			else
				document.getElementById("status").innerHTML = "<span>" + text + "</span>";
		}

		function drawRectangles(predictions, sortByConfidence = true) {

			if (!img.width || !img.height)
				return;

			if (!(predictions && predictions.length > 0))
				return;

			// Sort descending
			if (sortByConfidence) {
				predictions.sort(function (a, b) {
					return b.confidence - a.confidence;
				});
			}

			let svg = null;
			let xRatio = img.width * 1.0 / img.naturalWidth;
			let yRatio = img.height * 1.0 / img.naturalHeight;

			if (useSVG) {
				svg = `
					<svg viewBox="0 0 ${img.width} ${img.height}">
					<defs>
						<mask id="mask">
							<rect fill="#999" x="0" y="0" width="${img.width}" height="${img.height}"></rect>`;
			}
			else {
				let context = annotations.getContext("2d");
				context.clearRect(0, 0, annotations.width, annotations.height);
				context.lineWidth = "1";
			}

			for (let i = 0; i < predictions.length; i++) {
                let prediction = predictions[i];
				let left   = Math.min(prediction.x_min,  prediction.x_max) * xRatio;
				let top    = Math.min(prediction.y_min,  prediction.y_max) * yRatio;
				let width  = Math.abs(prediction.x_min - prediction.x_max) * xRatio;
                let height = Math.abs(prediction.y_min - prediction.y_max) * yRatio;

				if (useSVG) {
					svg += `<rect fill="#ffffff" x="${left}" y="${top}" width="${width}" height="${height}"></rect>`;
				}
				else {
					context.strokeStyle = "red";
					context.strokeRect(left, top, width, height);
					context.strokeStyle = "yellow";
                    context.strokeText(i + " " + (prediction.label || ""), left, top);
				}
			}

			if (useSVG) {
				svg += `
																</mask>
															</defs>
															<image mask="url(#mask)" xmlns:xlink="http://www.w3.org/1999/xlink"
																   xlink:href="${img.src}" width="${img.width}" height="${img.height}"></image>`;

				let colors = ["179,221,202", "204,223,120", "164,221,239"];
				let colorIndex = 0;

				let maxLineWidth = predictions.length > 5 ? (predictions.length > 10 ? 2 : 5) : 15;
				for (let i = 0; i < predictions.length; i++) {

					let prediction = predictions[i];
					let left   = Math.min(prediction.x_min,  prediction.x_max) * xRatio;
					let top    = Math.min(prediction.y_min,  prediction.y_max) * yRatio;
					let width  = Math.abs(prediction.x_min - prediction.x_max) * xRatio;
					let height = Math.abs(prediction.y_min - prediction.y_max) * yRatio;

					let right  = left + width;
					let bottom = top + height;

					// CodeProject.AI style
					let lineWidth   = Math.min(maxLineWidth, width / 10);
					let blockWidth  = (width - lineWidth) / 5;
					let blockHeight = (height - lineWidth) / 5;
					let color       = colors[colorIndex++ % colors.length];
					let styleSolid  = `style="stroke:rgba(${color}, 1);stroke-width:${lineWidth}"`;
					let styleTrans  = `style="stroke:rgba(${color}, 0.5);stroke-width:${lineWidth}"`;

					// label
                    let label = prediction.label || prediction.userid;
					if (label)
						svg += `<text x="${left}" y="${top - lineWidth}" style="stroke: none; fill:rgba(${color}, 1);font-size:12px">${label || ""}</text>`;

					// Shortcut if there are just too many items
					if (predictions.length > 15) {
						// Solid rectangle
						svg += `<rect stroke="rgb(${color})" stroke-width="1px" fill="transparent" x="${left}" y="${top}" width="${width}" height="${height}"></rect>`;
						continue;
					}

					// Top (left to right)
					let x = left - lineWidth / 2;
					svg += `<line ${styleSolid} x1="${x}" y1="${top}" x2="${x + blockWidth + lineWidth}" y2="${top}"/>`;
					x += blockWidth + lineWidth;
					svg += `<line ${styleTrans} x1="${x}" y1="${top}" x2="${x + blockWidth}" y2="${top}"/>`;
					x += 2 * blockWidth; // skip a section
					svg += `<line ${styleSolid} x1="${x}" y1="${top}" x2="${x + 2 * blockWidth + lineWidth}" y2="${top}"/>`;

					// Right (top to bottom)
					let y = top - lineWidth / 2;
					svg += `<line ${styleSolid} x1="${right}" y1="${y}" x2="${right}" y2="${y + blockHeight + lineWidth}"/>`;
					y += blockHeight + lineWidth;
					svg += `<line ${styleTrans}  x1="${right}" y1="${y}" x2="${right}" y2="${y + blockHeight}"/>`;
					y += 2 * blockHeight; // skip a section
					svg += `<line ${styleSolid} x1="${right}" y1="${y}" x2="${right}" y2="${y + 2 * blockHeight + lineWidth}"/>`;

					// Bottom (left to right)
					x = left - lineWidth / 2;
					svg += `<line ${styleSolid} x1="${x}" y1="${bottom}" x2="${x + 2 * blockWidth + lineWidth}" y2="${bottom}"/>`;
					x += 3 * blockWidth + lineWidth; // Skip a section
					svg += `<line ${styleTrans}  x1="${x}" y1="${bottom}" x2="${x + blockWidth}" y2="${bottom}"/>`;
					x += blockWidth;
					svg += `<line ${styleSolid} x1="${x}" y1="${bottom}" x2="${x + blockWidth + lineWidth}" y2="${bottom}"/>`;

					// Left (top to bottom)
					y = top - lineWidth / 2;
					svg += `<line ${styleSolid} x1="${left}" y1="${y}" x2="${left}" y2="${y + 2 * blockHeight + lineWidth}"/>`;
					y += 3 * blockHeight + lineWidth; // skip a section
					svg += `<line ${styleTrans}  x1="${left}" y1="${y}" x2="${left}" y2="${y + blockHeight}"/>`;
					y += blockHeight;
					svg += `<line ${styleSolid} x1="${left}" y1="${y}" x2="${left}" y2="${y + blockHeight + lineWidth}"/>`;
				}

				svg += `
														</svg>`;

				imageMask.innerHTML = svg;
				img.style.visibility = "hidden";
			}
		}

		function getInferenceTimingHtml(data) {

			let html = "<table class='timing-table'>";
			if (data.analysisRoundTripMs)
				html += `<tr><td>Analysis round trip</td><td>${data.analysisRoundTripMs} ms</td></tr>`;
			if (data.processMs)
				html += `<tr><td>Processing</td><td>${data.processMs} ms</td></tr>`;
			if (data.inferenceMs)
				html += `<tr><td>Inference</td><td>${data.inferenceMs} ms</td></tr>`;
			html += "</table>";

			return html;
		}

        function displayPredictionResults(data, sortByConfidence = true) {

			if (!data || !data.predictions || !data.predictions.length) {
				setResultsHtml("No predictions returned");
				return;
			}

			// Sort descending
			if (sortByConfidence) {
				data.predictions.sort(function (a, b) {
					return b.confidence - a.confidence;
				});
			}

			let html = "<table style='width:100%'><tr><th>#</th>"
			         + "<th>Label</th><th>Confidence</th></tr>";
			for (let i = 0; i < data.predictions.length; i++) {
				let pred = data.predictions[i];
				html += `<tr><td>${i}</td><td>${pred.label || "Face"}</td>`
				      + `<td>${confidence(pred.confidence)}</td></tr>`;
			}
			html += "</table>";

			html += getInferenceTimingHtml(data);

			setResultsHtml(html);
		}

		function displayRecognitionResults(data) {

			if (!(data.predictions && data.predictions.length > 0)) {
				setResultsHtml("No recognitions returned");
				return;
			}

			// Sort descending
			data.predictions.sort(function (a, b) {
				return b.confidence - a.confidence;
			});

			let html = "<table style='width:100%'><tr><th>#</th><th>Name</th><th>Confidence</th></tr>";
			for (let i = 0; i < data.predictions.length; i++) {
				let recog = data.predictions[i];
				html += "<tr><td>" + i + "</td><td>" + (recog.userid || "Face")
					+ "</td><td>" + confidence(recog.confidence) + "</td></tr>";
			}
			html += "</table>";

			html += getInferenceTimingHtml(data);

			setResultsHtml(html);
		}

		function displayMatchResults(match) {

			if (!match) {
				setResultsHtml("No matches returned");
				return;
			}

			let html = "Match: " + confidence(match.similarity);

			html += getInferenceTimingHtml(match);

			setResultsHtml(html);
		}

		function displayBaseResults(base) {

			if (!base) {
				setResultsHtml("No results returned");
				return;
			}

			let html = base.success ? "Operation successful" : "Operation failed";

			html += getInferenceTimingHtml(base);
	
			setResultsHtml(html);
		}

		function displayRegisteredFaces(data) {

			if (!data || data.faces == null || data.faces.length <= 0) {
				setResultsHtml("No faces registered");
				return;
			}

			let html = "";
			for (let name of data.faces)
				html += name + "<br>";

			setResultsHtml(html);
		}

		// Not actually used. We probably should though.
		function setResultsHtml(html) {
			result.innerHTML = html;
		}

		function confidence(value) {
			if (value == undefined) return '';

			return Math.round(value * 100.0) + "%";
		}

		async function ping() {

			let url = serviceUrl.value.trim() + '/v1/status/ping';

			const controller  = new AbortController()
			const timeoutSecs = parseInt(serviceTimeoutSecTxt.value);
			const timeoutId  = setTimeout(() => controller.abort(), timeoutSecs * 1000)

			await fetch(url, { method: "GET", signal: controller.signal })
				.then(response => {

					clearTimeout(timeoutId);

					if (!response.ok) {
						setError('Error contacting API server');
					}
					else {
						response.json().then(data => {
							serverOnline = data.success;
							if (serverOnline)
								setStatus('API server is online', "green");
							else // kinda impossible for an offline server to say "I'm offline", but hey...
								setError('API server is offline');
						})
						.catch(error => {
							setError('Unable to process server response', error)
						});
					}
				})
				.catch(error => {
					if (error.name === 'AbortError') {
						setError("Response timeout. Try increasing the timeout value");
						serverOnline = false;
					}
					else
						setError("API server is offline", error?.message);
				});
		}

		async function getAnalysisStatus() {

			// In the future we will ask for "logs since log ID 'x'" so we have
			// a full history. For now, a simple "last 10".
			let url = serviceUrl.value.trim() + '/v1/status/analysis/list';

			const controller  = new AbortController()
			const timeoutSecs = parseInt(serviceTimeoutSecTxt.value);
			const timeoutId   = setTimeout(() => controller.abort(), timeoutSecs * 1000)

			await fetch(url, { method: "GET", signal: controller.signal })
				.then(response => {

					clearTimeout(timeoutId);

					if (response.ok) {
						response.json().then(data => {

							if (data && data.statuses) {

								// disable all first
								let cards = document.getElementsByClassName('card');
								for (const card of cards)
									card.classList.replace('d-flex', 'd-none');

                                let navTabs = document.getElementsByClassName('nav-item');
                                for (const tab of navTabs)
                                    tab.classList.add('d-none');
								
								for (let i = 0; i < data.statuses.length; i++) {

									let moduleId = data.statuses[i].moduleId.replace(" ", "-");
									let running  = data.statuses[i].status == 'Started';

									let selector = data.statuses[i].queue;

									let cards = document.getElementsByClassName('card ' + selector);
									for (const card of cards) {
										if (running) {
											card.classList.replace('d-none', 'd-flex');
											let parent = card.parentNode;
											if (parent && parent.attributes["aria-labelledby"]) {
												let tabListItemId = parent.attributes["aria-labelledby"].value + "-listitem";
												let tabItem = document.getElementById(tabListItemId);
												if (tabItem.classList)
													tabItem.classList.remove('d-none');
												card.parentNode.parentNode.classList.remove('d-none');
											}
										}
									}
								}
							}
						})
					}
				})
                .catch(error => {
                    setStatus(/*error.message*/ "Unable to contact AI Server", "orange");
                });
		}

		async function submitRequest(route, apiName, images, parameters, doneFunc, failFunc) {

			setStatus("Sending request to AI server", "blue");

			let formData = new FormData();

			// Check file selected or not
			if (images && images.length > 0) {
				for (let i = 0; i < images.length; i++) {
					file = images[i];
					formData.append('image' + (i + 1), file);
				}
			}

			if (parameters && parameters.length > 0) {
				for (let i = 0; i < parameters.length; i++) {
					keypair = parameters[i];
					formData.append(keypair[0], keypair[1]);
				}
			}

			let url = serviceUrl.value.trim() + '/v1/' + route + '/' + apiName;

			const controller  = new AbortController()
			const timeoutSecs = parseInt(serviceTimeoutSecTxt.value);
			const timeoutId   = setTimeout(() => controller.abort(), timeoutSecs * 1000)

			await fetch(url, {
				method: "POST",
				body: formData,
				signal: controller.signal
			})
				.then(response => {

					clearTimeout(timeoutId);

					if (response.ok) {
						response.json().then(data => {
							if (data) {
								if (doneFunc) doneFunc(data)
							}
							else {
								if (failFunc) failFunc();
								setError('No data was returned');
							}
						})
						.catch(error => {
							if (failFunc) failFunc();
							setError("Unable to process server response", error);
						})					
					} else {
						setError('Error contacting API server');
						if (failFunc) failFunc();						
					}
				})
				.catch(error => {
                    if (failFunc) failFunc();

					if (error.name === 'AbortError') {
						setError("Response timeout. Try increasing the timeout value");
						serverOnline = false;
					}
					else
						setError('Unable to complete API call', error);
				});
		}

		function onDetectScene(fileChooser) {

			clearCanvas();

			if (fileChooser.files.length == 0) {
				alert("No file was selected for scene detection");
				return;
			}

			setImage(fileChooser.files[0]);
			let images = [fileChooser.files[0]];

			setResultsHtml("Classifying scene...");
			submitRequest('vision', 'scene', images, null, function (data) {
				setResultsHtml("<table style='width:100%'>" +
							   "<tr><th>Label</th><th>Confidence</th></tr><tr>" +
							   "<tr><td> " + data.label + "</td>" +
							   "<td> " + confidence(data.confidence) + "</td ></tr> " +
							   "<table>" +
							   getInferenceTimingHtml(data));
			});
		}

		function onDetectFaces(fileChooser) {

			clearCanvas();

			if (fileChooser.files.length == 0) {
				alert("No file was selected for face detection");
				return;
			}

			setImage(fileChooser.files[0]);
			let images = [fileChooser.files[0]];

			setResultsHtml("Detecting faces...");
			submitRequest('vision', 'face', images, null, function (data) {
				drawRectangles(data.predictions);
				displayPredictionResults(data)
			});
		}

		function setCustomModelLists() {
			setCustomModelList(customModel);
			setCustomModelList(benchmarkModel, true);
		}

		function setCustomModelList(selectList, add_extras) {

			submitRequest('vision', 'custom/list', null, null, function (data) {

				while (selectList.options.length)
					selectList.remove(0);

				if (add_extras) {
					selectList.options.add(new Option("Standard model", ""));
					selectList.options.add(new Option("No inference: round-trip speed test only", "round-trip"));
				}

				for (let i = 0; i < data.models.length; i++) {

					let title;
					switch (data.models[i].toLowerCase()) {
						// case 'ipcam-general': title = 'General IP Cam'; break;
						case 'license-plate': title = 'License Plates v2'; break;
						case 'openlogo': title = 'Open Logo'; break;
						case 'actionnetv2': title = '(Human) ActionNet v2'; break;
						default: title = data.models[i];
					}

					let model = new Option(title, data.models[i]);
					selectList.options.add(model);
				}
			});
		}

		function onCustomDetect(model_name, fileChooser) {

			clearCanvas();

			if (fileChooser.files.length == 0) {
				alert("No file was selected for custom object detection");
				return;
			}

			setImage(fileChooser.files[0]);
			let images = [fileChooser.files[0]];

			setResultsHtml("Detecting objects using custom model...");
			submitRequest('vision', 'custom/' + model_name, images, null, function (data) {
				drawRectangles(data.predictions);
				displayPredictionResults(data)
			});
		}

		function onDetectThings(fileChooser) {

			clearCanvas();

			if (fileChooser.files.length == 0) {
				alert("No file was selected for vision detection");
				return;
			}

			setImage(fileChooser.files[0]);
			let images = [fileChooser.files[0]];

			setResultsHtml("Detecting objects...");
			submitRequest('vision', 'detection', images, null, function (data) {
				drawRectangles(data.predictions);
				displayPredictionResults(data)
			});
		}

		function onCompareFaces(face1Ctrl, face2Ctrl) {

			clearCanvas();

			if (face1Ctrl.files.length == 0 || face2Ctrl.files.length == 0) {
				alert("Please supply two faces for face comparison");
				return;
			}

			setImage(face1Ctrl.files[0]);
			let images = [face1Ctrl.files[0], face2Ctrl.files[0]];

			setResultsHtml("Comparing faces...");
			submitRequest('vision', 'face/match', images, null, function (data) {
				displayMatchResults(data);
			});
		}

		function onRegisterFaces(userId, faceCtrl) {

			clearCanvas();

			if (faceCtrl.files.length == 0) {
				alert("No files were selected for face registration");
				return;
			}

			if (!userId) {
				alert("No name supplied");
				return;
			}

			setImage(faceCtrl.files[0]);

			let images = [];
			for (let i = 0; i < faceCtrl.files.length; i++)
				images.push(faceCtrl.files[i]);

			setResultsHtml("Registering face...");
			submitRequest('vision', 'face/register', images, [["userid", userId]], function (data) {
				if (data)
					displayBaseResults(data);
				else
					setResultsHtml("Unable to register faces");
			});
		}

		function onListRegisteredFaces() {

			clearCanvas();

			setResultsHtml("Listing faces...");
			submitRequest('vision', 'face/list', null, null, function (data) {
				displayRegisteredFaces(data)
			});
		}

		function onDeleteFace(userId) {

			clearCanvas();

			setResultsHtml("Deleting face info...");
			submitRequest('vision', 'face/delete', null, [["userid", userId]], function (data) {
				setResultsHtml("Face deleted");
			});
		}

		function onRecogniseFace(fileChooser, minimumConfidence) {

			clearCanvas();

			if (fileChooser.files.length == 0) {
				alert("No file was selected for face recognition");
				return;
			}

			setImage(fileChooser.files[0]);
			let images = [fileChooser.files[0]];

			let params = []
			let minConfidence = parseFloat(minimumConfidence);
			if (!isNaN(minConfidence))
				params = [["min_confidence", minConfidence]]

			setResultsHtml("Recognizing face...");
			submitRequest('vision', 'face/recognize', images, params, function (data) {
				drawRectangles(data.predictions);
				displayRecognitionResults(data)
			});
		}

		function onRemoveBackground(fileChooser, use_alphamatting) {

			clearCanvas();

			if (fileChooser.files.length == 0) {
				alert("No file was selected for background removal");
				return;
			}

			setImage(fileChooser.files[0]);
			let images = [fileChooser.files[0]];
			let params = [["use_alphamatting", use_alphamatting]]

			setResultsHtml("Removing background...");
			submitRequest('image', 'removebackground', images, params, function (data) {
				setResultsHtml("Background Removal complete" + getInferenceTimingHtml(data));
				img.src = "data:image/png;base64," + data.imageBase64;
				img.style.visibility = "visible";
			});
		}

		function onBlurBackground(fileChooser, strength) {

			clearCanvas();

			if (fileChooser.files.length == 0) {
				alert("No file was selected for background bluring");
				return;
			}

			setImage(fileChooser.files[0]);
			let images = [fileChooser.files[0]];
			let params = [["strength", strength]]

			setResultsHtml("Blurring background...");
			submitRequest('image', 'portraitfilter', images, params, function (data) {
				setResultsHtml("Portrait mode complete" + getInferenceTimingHtml(data));
				img.src = "data:image/png;base64," + data.filtered_image;
				img.style.visibility = "visible";
			});
		}

		function onCartoonise(model_name, fileChooser) {

			clearCanvas();

			if (fileChooser.files.length == 0) {
				alert("No file was selected for cartoonisation");
				return;
			}

			setImage(fileChooser.files[0]);
			let images = [fileChooser.files[0]];

			params = [["model_name", model_name]]

			setResultsHtml("Cartoonising face...");
			submitRequest('image', 'cartoonise', images, params, function (data) {
				setResultsHtml("onCartoonisation complete" + getInferenceTimingHtml(data));
				img.src = "data:image/png;base64," + data.imageBase64;
				img.style.visibility = "visible";
			});
		}		

        function onReadLicensePlate(fileChooser, confidence) {

            clearCanvas();

            if (fileChooser.files.length == 0) {
                alert("No file was selected for license plate detection");
                return;
            }

            setImage(fileChooser.files[0]);
            let images = [fileChooser.files[0]];
            let params = [["confidence", confidence]]

			setResultsHtml("Detecting license plates...");
            submitRequest('image', 'alpr', images, params, function (data) {
				setResultsHtml("License plate detection complete");
                drawRectangles(data.predictions, false);
                displayPredictionResults(data, false)
            });
		}

        function onReadText(fileChooser) {

            clearCanvas();

            if (fileChooser.files.length == 0) {
                alert("No file was selected for optical character recognition");
                return;
            }

            setImage(fileChooser.files[0]);
            let images = [fileChooser.files[0]];
			let params = null; 

			setResultsHtml("Reading text from image...");
            submitRequest('image', 'ocr', images, params, function (data) {
                setResultsHtml("Optical character recognition complete");
                drawRectangles(data.predictions, false);
                displayPredictionResults(data, false)
            });
		}

		function onSuperResolution(fileChooser) {

			clearCanvas();

			if (fileChooser.files.length == 0) {
				alert("No file was selected for image enhancement");
				return;
			}

			setImage(fileChooser.files[0]);
			let images = [fileChooser.files[0]];
			let params = null;

			setResultsHtml("Increasing image resolution...");
			submitRequest('image', 'superresolution', images, params, function (data) {
				setResultsHtml("Resolution Improvement complete" + getInferenceTimingHtml(data));
				img.src = "data:image/png;base64," + data.imageBase64;
				img.style.visibility = "visible";
			});
		}

		function onSummarizeText(articleText, numberOfSentences) {

			clearCanvas();

			if (!articleText) {
				alert("No text was provided for text summary");
				return;
			}

			numberOfSentences = !isNaN(numberOfSentences) ? parseInt(numberOfSentences) : 2;
			let params = [['text', articleText], ["num_sentences", numberOfSentences]]

			setResultsHtml("Summarizing text...");
			submitRequest('text', 'summarize', null, params, function (data) {
				setResultsHtml((data.summary || "No summary  was returned") +
				               getInferenceTimingHtml(data));
			});
		}

		function onAnalyzeSentiment(articleText) {

			clearCanvas();

			if (!articleText) {
				alert("No text was provided for sentiment analysis");
				return;
			}

			let params = [['text', articleText]]

			setResultsHtml("Performing sentiment analysis...");
			submitRequest('text', 'sentiment', null, params, function (data) {
				if (!data.success) {
					setResultsHtml("Sentiment analysis failed");
				}
				else {
					setResultsHtml("Probability that text is positive is " +
								   (data.positive_probability * 100).toFixed(1) + "%. " +
								   "Text sentiment is " + (data.is_positive ? "positive" : "negative") +
								   getInferenceTimingHtml(data));
				}
			});
		}

        const useRequestAnimationFrame = true;
        const framePerSecond           = 5; // Only if useRequestAnimationFrame = false

		let videoProcessingActive = false;
		let videoTimerId;
        let lastFrameDrawTime, lastInferenceTime, framesPerSecond, processedPerSecond;
		let predictions;
		let processQueueLength = 0;

		function onStartVideo(e) {

			const video = document.getElementById('video');

			if (navigator.mediaDevices.getUserMedia) {

                navigator.mediaDevices.getUserMedia({ video: true })
                    .then((stream) => {
						video.srcObject = stream;

						videoProcessingActive = true;
                        lastFrameDrawTime     = performance.now();

                        if (useRequestAnimationFrame)
							requestAnimationFrame(drawVideoDetection);
						else
							videoTimerId = setInterval(drawVideoDetection, 1000 / framePerSecond);
                    })
                    .catch((e) => {
                        console.log("Unable to capture webcam stream");
                    });
			}

			return false;
		}

		function drawVideoDetection() {

            const video   = document.getElementById('video');
            const canvas  = document.getElementById('canvas');
            canvas.width  = video.videoWidth;
            canvas.height = video.videoHeight;

			let ctx = canvas.getContext('2d');

			// Draw the current image, the previous detection rect, and the stats
			ctx.drawImage(video, 0, 0); //, canvas.width, canvas.height);

			if (predictions) {
				for (let i = 0; i < predictions.length; i++) {

					const rect = predictions[i];
					const rect_left   = Math.min(rect.x_min, rect.x_max);
					const rect_top    = Math.min(rect.y_min, rect.y_max);
					const rect_width  = Math.abs(rect.x_min - rect.x_max);
					const rect_height = Math.abs(rect.y_min - rect.y_max);

					ctx.strokeStyle = "red";
					ctx.strokeRect(rect_left, rect_top, rect_width, rect_height);
		
					ctx.strokeStyle = "yellow";
					ctx.strokeText(predictions[i].label || "", rect_left, rect_top);
				}
			}

			if (framesPerSecond) {
				ctx.font         = '20px sans-serif';
				ctx.strokeStyle  = "black";
				ctx.fillStyle    = "white";
				ctx.textAlign    = 'right';
				ctx.textBaseline = 'top';
                if (processedPerSecond)
                    ctx.fillText(`${framesPerSecond.toFixed(1)} FPS, ${processedPerSecond.toFixed(1)} detects/sec`, canvas.width - 10, 10);
				else
                    ctx.fillText(`${framesPerSecond.toFixed(1)} FPS`, canvas.width - 10, 10);
			}

			let previousFrameDrawTime = lastFrameDrawTime;
			lastFrameDrawTime = performance.now();

            // Draw previous face detection and move on
			if (processQueueLength > 0) {

				if (useRequestAnimationFrame && videoProcessingActive)
					requestAnimationFrame(drawVideoDetection);

				return;
			}

            if (previousFrameDrawTime && previousFrameDrawTime < lastFrameDrawTime)
                framesPerSecond = 1000.0 / (lastFrameDrawTime - previousFrameDrawTime);

			canvas.toBlob((blob) => {

				if (blob) {

					let formData = new FormData();
					formData.append('image', blob, 'filename.png');

					// let url = serviceUrl.value.trim() + '/v1/vision/face';	// Face detection
					let url = serviceUrl.value.trim() + '/v1/vision/detection';	// object detection

					processQueueLength++;

					fetch(url, {
						method: "POST",
						body: formData
					})
						.then(response => {
							processQueueLength--;
							if (response.ok) 
								response.json().then(data => {
									if (videoProcessingActive && data && data.success && data.predictions) {

										let previousInferenceTime = lastInferenceTime;
										lastInferenceTime = performance.now();

										if (previousInferenceTime && previousInferenceTime < lastInferenceTime)
											processedPerSecond = 1000.0 / (lastInferenceTime - previousInferenceTime);

										predictions = data.predictions
										for (let i = 0; i < predictions.length; i++) {

											const rect = predictions[i];
											const rect_left   = Math.min(rect.x_min, rect.x_max);
											const rect_top    = Math.min(rect.y_min, rect.y_max);
											const rect_width  = Math.abs(rect.x_min - rect.x_max);
											const rect_height = Math.abs(rect.y_min - rect.y_max);

											ctx.strokeStyle = "red";
											ctx.strokeRect(rect_left, rect_top, rect_width, rect_height);
								
											ctx.strokeStyle = "yellow";
            								ctx.strokeText(predictions[i].label || "", rect_left, rect_top);
										}
									}
								})
						})
						.catch(e => {
                            processQueueLength--;
						});
				}

                if (useRequestAnimationFrame && videoProcessingActive)
					requestAnimationFrame(drawVideoDetection);
			});
		}

		function onStopVideo(e) {

			videoProcessingActive = false;
            if (!useRequestAnimationFrame && videoTimerId)
				clearInterval(videoTimerId);

			let stream = video.srcObject;
			try {
				let tracks = stream.getTracks();

				for (let i = 0; i < tracks.length; i++) {
					let track = tracks[i];
					track.stop();
				}
			}
			catch { }

            video.srcObject = null;

			return false;
        }

		const maxSimultaneous = 9;
        const maxBenchmarkRequests = 50;
        let totalBenchmarkRequests = 0;

		function onBenchmark(fileChooser, model_name, resultElm) {

			clearCanvas();

			let images = null;
			let route = model_name ? ('custom/' + model_name) : 'detection';

			if (benchmarkModel.value == "round-trip") {
				route = "custom/list";
			}
			else {
				if (fileChooser.files.length == 0) {
					alert("No file was selected for benchmarking");
					return;
				}

				setImage(fileChooser.files[0]);
				images = [fileChooser.files[0]];
			}

			let startMilliseconds = performance.now();

			// Warm up
			for (let i = 0; i < 3; i++) {
				submitRequest('vision', route, images, null, function (data) {
					resultElm.innerHTML = "Warm up " + i;
				});
			}

			// Benchmark
            totalBenchmarkRequests = 0;
			for (let i = 0; i < maxSimultaneous; i++)
                sendBenchmarkRequest(route, images, startMilliseconds, resultElm);
		}

        function sendBenchmarkRequest(route, images, startMilliseconds,  resultElm) {

			console.log("About to send Benchmark Request")

            totalBenchmarkRequests++;
            submitRequest('vision', route, images, null,
                (data) => {
					console.log("Benchmark Request succeeded")

                    let currentMilliseconds = performance.now();
                    let opsPerSecond = (totalBenchmarkRequests * 1000) / (currentMilliseconds - startMilliseconds);
                    resultElm.innerHTML = opsPerSecond.toFixed(1) + " operations per second - " + totalBenchmarkRequests + "/50";

                    if (totalBenchmarkRequests < maxBenchmarkRequests)
                        sendBenchmarkRequest(route, images, startMilliseconds, resultElm);
                },
				() => {
					console.log("Benchmark Request failed")
                    // if (totalBenchmarkRequests < maxBenchmarkRequests)
                    //    sendBenchmarkRequest(route, images, startMilliseconds, resultElm);
				}
            );
		}

		// -------------- Training YoloV5 custom model -------------------------

		let trainingResultsShown = true; // Have successful results been displayed?
									     // initialize to true or onTrainingModelInfo 
										 // will be called on the first onTrainingStatus call.

		function onTrainingStatus() {

			// only get status if panel is active
			const panel = document.getElementById('train-panel');
            if (!panel.classList.contains("active"))
                return;

            submitRequest('train', 'status', null, null, 
				function (data) {
					if (data.success) {
					
						// TODO: Would be nice (but not necessary) to have the training module calculate
						// these values for us so we don't have to keep up with enums and states
						let actionActive           = data.state == "Running"; // || data.state == "Initializing" || data.state == "Cancelling";
						let creatingDataset        = actionActive && data.action == "CreateDataset";
						let doingTraining          = actionActive && (data.action == "TrainModel" ||
						                                              data.action == "ResumeTrainModel");

						trainingModelName.value    = data.model_name;
                        trainingDatasetName.value  = data.dataset_name
						trainingAction.value       = data.action;
						trainingState.value        = data.state;
						statusMessage.value        = data.message;

						trainingState.classList.remove("text-success", "bg-success", "fw-bold", "text-warning", "bg-danger");
						trainingCancelBtn.setAttribute('disabled', true);
						trainingCancelBtn.setAttribute('hidden', true);

						if (data.state == "Initializing" || data.state == "Running") {
							trainingState.classList.add("text-success", "fw-bold");
							trainingCancelBtn.removeAttribute('disabled')
							trainingCancelBtn.removeAttribute('hidden')
							trainingCancelBtn.value = doingTraining ? "Pause" : "Cancel";
						}
						else if (data.state == "Completed")
							trainingState.classList.add("bg-success");
						else if (data.state == "Cancelling" || data.state == "Cancelled")
							trainingState.classList.add("text-warning", "fw-bold");
						else if (data.state == "Failed")
							trainingState.classList.add("bg-danger");

						let progressStr = (data.progress||0).toFixed(0);

						// Default state for progress bars is hidden
						datasetProgress.parentElement.classList.add("bg-transparent");
						datasetProgress.innerHTML = "";
						trainingProgress.parentElement.classList.add("bg-transparent");
						trainingProgress.innerHTML = "";

						if (creatingDataset) {
							datasetProgress.innerHTML = progressStr + "%";
							datasetProgress.parentElement.classList.remove("bg-transparent");
							//	onTrainingDatasetInfo(data.dataset_name);

							if (data.progress < 1)
								datasetProgress.classList.add("progress-bar-striped", "progress-bar-animated");
							else
								datasetProgress.classList.remove("progress-bar-striped", "progress-bar-animated");
							datasetProgress.ariaValueNow = progressStr;
						}
						else {
							datasetProgress.classList.remove("progress-bar-striped", "progress-bar-animated");
							// Previously we wanted the dataset creation progress bar to sit at 100%
							// while the training (that presumably used the created dataset) continued.
							// This isn't actually realistic :(
							// datasetProgress.ariaValueNow = data.dataset_created ? "100" : "0";
							datasetProgress.ariaValueNow = "0";
						}

						if (doingTraining) {
							trainingProgress.innerHTML  = progressStr + "%";
							trainingProgress.parentElement.classList.remove("bg-transparent");
							onTrainingModelInfo(data.model_name);

							if (data.progress < 1)
								trainingProgress.classList.add("progress-bar-striped", "progress-bar-animated");
							else
								trainingProgress.classList.remove("progress-bar-striped", "progress-bar-animated");
							trainingProgress.ariaValueNow = progressStr;
						}
						else {
							trainingProgress.classList.remove("progress-bar-striped", "progress-bar-animated");
							trainingProgress.ariaValueNow = "0";
						}

						// We never know when each status call is done, and between calls the training
						// may have ended. If this is the case, we need to ensure we've done one last
						// info update to get the final results.
						if (!trainingResultsShown && !doingTraining) {
							trainingResultsShown = true;
							onTrainingModelInfo(data.model_name);
						}

						datasetProgress.style.width  = datasetProgress.ariaValueNow + "%";
						trainingProgress.style.width = trainingProgress.ariaValueNow + "%";
					}
					else {
						trainingAction.value  = "Unknown"
						trainingState.value   = "Unknown";
					}
				},
				function (data) {
				});
		}

		function onDatasetCreate(dataset_name, classes, num_images)
		{
            params = [
                ["dataset_name", dataset_name],
                ["classes", classes],
                ["num_images", num_images],
            ];
            setResultsHtml("Starting dataset creation");

            submitRequest('train', 'create_dataset', null, params,
                function (data) {
                    if (data.success)
						setResultsHtml(`Create the Dataset '${dataset_name}'`);
                    else
                        setResultsHtml(`Create Dataset failed to start. ${data.error ? "(" + data.error + ")" : ''}`);
                },
                function (data) {
                    if (data)
                        setResultsHtml(`Create Dataset failed to start. ${data.error ? "(" + data.error + ")" : ''}`);
                    else
                        setResultsHtml("Create Dataset failed to start");
				}
			);
		}

		function onTrainingStart(model_name, dataset_name, model_size, num_epochs, batch, device, 
								freeze, hyp, patience, workers) {

			params = [
                [ "model_name",   model_name   ],
                [ "dataset_name", dataset_name ],
				[ "model_size",   model_size   ],
				[ "num_epochs",   num_epochs   ],
				[ "device",       device       ],
				[ "batch",        batch        ],
				[ "freeze",       freeze       ],
				[ "hyp" ,         hyp          ],
				[ "patience",     patience     ],
				[ "workers",      workers      ]
			];

			setResultsHtml("Starting model training");

            submitRequest('train', 'train_model', null, params, 
				function (data) {
					if (data.success) {
						setResultsHtml("Training started for model " + model_name);
						trainingResultsShown = false;
					}
					else
						setResultsHtml(`Training failed to start. ${data.error? "(" + data.error + ")" : ''}`);
				},
				function (data) {
					if (data)
	                    setResultsHtml(`Training failed to start. ${data.error? "(" + data.error + ")" : ''}`);
					else
						setResultsHtml("Training failed to start");
                });
		}

		function onTrainingResumeTraining(model_name) {

            params = [
                ["model_name", model_name]
            ];
            setResultsHtml("Resume Training model {model_name}");

            submitRequest('train', 'resume_training', null, params,
                function (data) {
                    if (data.success) {
                        // NOTE: if TrainingYOLO has train_in_separate_task = False then the data
                        // object will contain all the info of the newly created model

                        setResultsHtml("Resuming training for model " + model_name);
                        trainingResultsShown = false;
                    }
                    else
                        setResultsHtml(`Resume Training failed to start. ${data.error ? "(" + data.error + ")" : ''}`);
                },
                function (data) {
                    if (data)
                        setResultsHtml(`Resume Training  failed to start. ${data.error ? "(" + data.error + ")" : ''}`);
                    else
                        setResultsHtml("Resume Training  failed to start");
                }
            );
		}

		function onTrainingCancel() {

            clearCanvas();

			submitRequest('train', 'cancel', null, null, 
				function (data) {

					if (data.success)
						setResultsHtml("Training cancel requested");
					else
						setResultsHtml(`Training was already cancelled.`);
				},
				function (data) {
					if (data)
	                    setResultsHtml(`Training failed to cancel. ${data.error? "(" + data.error + ")" : ''}`);
					else
						setResultsHtml("Training failed to cancel");
                });
		}

		function onTrainingModelInfo(model_name) {

			if (!model_name) {
                setResultsHtml("Get Model Info Failed: Model Name is required.")
				return
			}

			params = [["model_name", model_name]]
            submitRequest('train', 'model_info', null, params, 
				function (data) {
					if (data.success) {
						let model_created = data.model_created
						let resultHtml    = "Get Training Model Info:"
									      + "<br/><b>Model Name:</b> " + model_name + " (" + data.model_size + "Mb)"
									      + "<br/><b>Training State:</b> " + (model_created ? "Complete" : "Not Complete") // Need to detect "failed"
									      + "<br/><br/><b>Model Path:</b><br/> " + (data.model_path || "Not yet available")
									      + "<br/><br/><b>Results Graph Path:</b><br/>  " + (data.results_graph_path || "Not yet available")
									      + "<br/><br/><b>Results CSV:</b><br/> " + (data.results_csv_path || "Not yet available")
									      + "<br/><br/><b>PR Curve Graph Path:</b><br/> " + (data.pr_curve_path || "Not yet available")
									      + getInferenceTimingHtml(data);
						setResultsHtml(resultHtml);

						if (data.results_graph_image) {
							img.src = "data:image/png;base64," + data.results_graph_image;
							img.style.visibility = "visible";
						}
						else {
							img.src = "";
							img.style.visibility = "hidden";
						}

						if (data.pr_curve_image) {
							img2.src = "data:image/png;base64," + data.pr_curve_image;
							// results_img.src = "file://" + data.pr_curve_path;
							img2.style.visibility = "visible";
						}
						else {
							img2.src = "";
							img2.style.visibility = "hidden";
						}
					}
					else
                        setResultsHtml("Training: Unable to get Model info");
				},
                function (data) {
                    if (data)
                        setResultsHtml("Training: Unable to get Model info:" + data.error);
                    else
                        setResultsHtml("Training: Unable to get Model info");
                });
		}

		// Auto-populate the dataset name if nothing there
		function onDatasetNameChange() {
			if (!trainingInputModelDatasetName.value && trainingInputDatasetName.value)
				trainingInputModelDatasetName.value = trainingInputDatasetName.value;
		}

		function onTrainingDatasetInfo(dataset_name) {

			if (!dataset_name) {
                setResultsHtml("Get Dataset Info Failed: Dataset name is required.")
				return
			}

			params = [["dataset_name", dataset_name]]
            submitRequest('train', 'dataset_info', null, params, 
				function (data) {
					if (data.success) {
						let resultHtml = "Dataset Info:"
									   + "<br/><b>Dataset Name:</b> " + dataset_name + " (" + data.dataset_size + "Mb)"
                                       + "<br/><b>Creation State:</b> " + (data.dataset_created ? "Complete" : "Not Complete") // Need to detect "failed"
									   + "<br/><br/><b>Dataset Path:</b><br/> " + (data.dataset_path || "Not yet available")
									   + getInferenceTimingHtml(data);
						setResultsHtml(resultHtml);
					}
					else
                        setResultsHtml("Training: Unable to get dataset info");
				},
                function (data) {
                    if (data)
                        setResultsHtml("Training: Unable to get dataset info:" + data.error);
                    else
                        setResultsHtml("Training: Unable to get dataset info");
                });
		}
	</script>

</head>

<body class="dark-mode">
	<div>
		<div class=" mx-auto p-3" style="max-width:1100px;">

			<div class="w-100 header d-flex justify-content-start">
				<a href="https://www.codeproject.com" style="margin:2px 0 2px 5px">
					<svg version="1.1" xmlns="http://www.w3.org/2000/svg"
						 xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" role="img"
						 style="height: 60px; margin-right: -12px;">
						<title>CodeProject Icon</title>
						<path id="svg_2" d="M9.052,21.798c-0.236,0-0.459-0.905-0.463-1.145c-0.007-0.356,0.038-0.755,0.473-0.755
		c0.436,0,0.47,0.398,0.473,0.755C9.542,20.982,9.288,21.798,9.052,21.798z M10.903,23.985c0.729,0.004,3.677,0.151,3.715-0.847
		c0.041-0.998-1.401-1.525-2.234-1.563c-0.837-0.037-2.143,0.467-2.431,0.209c-0.377-0.339,0.281-1.882,0.531-2.188
		c0.172-0.205,0.453-0.524,0.606-0.664c0.594-0.553,0.967-1.32,0.964-2.178c-0.004-0.939-0.281-1.278,0.658-0.531
		c0.325,0.257,0.768,0.59,1.336,0.854c1.139,0.524-1.319-1.68-1.789-2.102c-0.788-0.699-1.045-1.08-0.609-1.354
		c0.346-0.216,0.672-0.459,0.977-0.723c1.196-1.035,2.046-2.605,1.878-4.896C14.354,5.911,10.416,0.024,9.364,0
		c-0.85-0.017-2.578,2.108-3.527,3.257C4.809,4.505,3.201,6.665,2.879,7.934C2.783,8.311,2.746,8.708,2.746,9.113
		c0,1.44,0.75,2.784,1.898,3.744c0.703,0.586,1.481,1.039,0.237,2.311c-0.74,0.758-2.434,2.361-1.453,1.909
		c0.572-0.264,1-0.614,1.34-0.854c0.709-0.504,0.99-0.669,0.833-0.031c-0.034,0.134-0.028,0.274-0.028,0.411
		c0,0.892,0.37,1.69,0.95,2.277c0.151,0.154,0.586,0.486,0.833,0.699c0.586,0.507,1.196,1.865,0.816,2.204
		c-0.288,0.258-1.594-0.246-2.427-0.209c-0.836,0.038-2.275,0.565-2.238,1.563s3.17,0.851,3.9,0.857
		c1.645,0.013,1.09-0.642,1.645-0.631C9.607,23.379,9.052,23.976,10.903,23.985z" />
						<path id="svg_3" fill="#C3DE6C" d="M9.802,1.187c-0.668-0.017-1.686,1.878-2.43,2.863C6.567,5.115,5.354,7.004,5.1,8.091
		C5.025,8.414,4.997,8.753,4.997,9.099c0,2.51,2.481,4.608,4.792,4.608c1.155,0,2.132-0.604,2.938-1.368
		c0.935-0.888,1.597-2.232,1.47-4.193C14.076,6.36,10.622,1.207,9.802,1.187z" />
						<path id="svg_4" d="M10.649,10.378c0.336,0.456,0.716,0.775,1.172,0.775c0.919,0,1.662-1.187,1.662-2.646
		c0-1.464-0.743-2.65-1.662-2.65c-0.456,0-0.85,0.309-1.172,0.775C10.491,6.86,10.2,7.042,9.823,6.401
		c-0.35-0.593-0.918-0.922-1.508-0.922c-1.179,0-2.135,1.412-2.135,3.154s0.956,3.154,2.135,3.154c0.737,0,1.371-0.556,1.769-1.389
		C10.238,10.073,10.47,10.135,10.649,10.378z" />
						<path id="svg_5" fill="#FFFFFF" d="M9.812,8.633c0,1.221-0.671,2.211-1.497,2.211c-0.826,0-1.498-0.991-1.498-2.211
		c0-1.224,0.672-2.215,1.498-2.215C9.141,6.418,9.812,7.409,9.812,8.633z" />
						<path id="svg_6" fill="#FFFFFF" d="M12.987,8.506c0,1.025-0.521,1.854-1.166,1.854c-0.641,0-1.162-0.83-1.162-1.854
		c0-1.029,0.521-1.858,1.162-1.858C12.465,6.648,12.987,7.478,12.987,8.506z" />
						<path id="svg_7" fill="#C3DE6C" d="M11.564,16.813c0,1.217-0.99,2.201-2.218,2.201c-1.227,0-2.221-0.984-2.221-2.201
		s0.994-2.205,2.221-2.205C10.574,14.608,11.564,15.597,11.564,16.813z" />
						<path id="svg_8" d="M9.877,17.434c0,0.229-0.188,0.415-0.418,0.415s-0.418-0.186-0.418-0.415S9.23,17.02,9.459,17.02
		S9.877,17.204,9.877,17.434z" />
						<path id="svg_9" d="M2.311,17.358c-0.165,0-1.687,0.021-2.163,0.227c-0.473,0.209,0.285,0.507,0.929,0.545
		c0.322,0.021,0.219,0.257,0.075,0.452c-1.155,1.581-0.264,1.262,0.514,0.565c0.192-0.171,0.264,0.056,0.284,0.265
		c0.018,0.206,0.511,1.749,0.665-0.209c0.062-0.81,0.113-1.241,0.076-1.525C2.653,17.396,2.499,17.358,2.311,17.358z" />
						<path id="svg_10" fill="#C3DE6C" d="M8.037,22.837c-0.284-0.527-1.063-0.452-1.422-0.395c-0.36,0.056-1.724,0.374-1.498,0.771
		c0.229,0.395,1.1,0.433,1.765,0.151C7.543,23.08,8.37,23.451,8.037,22.837z" />
						<path id="svg_11" d="M15.169,17.358c0.161,0,1.686,0.021,2.163,0.227c0.473,0.209-0.285,0.507-0.933,0.545
		c-0.319,0.021-0.216,0.257-0.075,0.452c1.158,1.581,0.267,1.262-0.511,0.565c-0.192-0.171-0.264,0.056-0.284,0.265
		c-0.021,0.206-0.515,1.749-0.665-0.209c-0.063-0.81-0.113-1.241-0.076-1.525C14.827,17.396,14.977,17.358,15.169,17.358z" />
						<path id="svg_12" fill="#C3DE6C" d="M10.086,22.837c0.284-0.527,1.063-0.452,1.423-0.395c0.359,0.056,1.728,0.374,1.497,0.771
		c-0.226,0.395-1.1,0.433-1.765,0.151C10.581,23.08,9.754,23.451,10.086,22.837z" />
						<path id="svg_13" d="M8.915,8.547c0,0.607-0.236,1.101-0.524,1.101c-0.288,0-0.521-0.494-0.521-1.101S8.103,7.447,8.39,7.447
		C8.678,7.447,8.915,7.94,8.915,8.547z" />
						<path id="svg_14" d="M12.291,8.455c0,0.483-0.188,0.877-0.418,0.877s-0.418-0.394-0.418-0.877c0-0.487,0.188-0.881,0.418-0.881
		S12.291,7.968,12.291,8.455z" />
					</svg>
				</a>

                <a href="https://www.codeproject.com/ai" style="margin:0px 5px 0 0">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 40 860 160" height="60px">
                <defs><style>.cls-1{fill:#fff;}.cls-2{fill:#b3ddca;}</style></defs>
                <g><title>CodeProject.AI</title>
                <path id="svg_1" class="cls-1" d="M 747.22 160.94 L 775.79 73.19 L 789.94 73.19 L 818.51 160.94 L 807.51 160.94 L 798.7 134.67 L 766.99 134.67 L 758.17 160.94 L 747.22 160.94 Z M 770.17 124.94 L 795.57 124.94 L 782.87 86.94 L 770.17 124.94 Z" fill="#231f20"></path><path id="svg_2" class="cls-1" d="M 817.73 160.94 L 817.73 73.22 L 828.73 73.22 L 828.73 160.94 L 817.73 160.94 Z" fill="#231f20"></path><rect x="756.7" width="22.1" height="11.6" style="stroke-opacity: 0.33; fill: rgb(179, 221, 202); fill-opacity: 0.33;" y="39"></rect><rect x="344.3" width="22.1" height="11.6" style="stroke-opacity: 0.33; fill: rgb(179, 221, 202); fill-opacity: 0.33;" y="32.4" transform="matrix(0, -1, 1, 0, 812.650024, 436.350006)"></rect><rect x="803.6" width="22.1" height="11.6" style="stroke-opacity: 0.33; fill: rgb(179, 221, 202); fill-opacity: 0.33;" y="185.3"></rect><rect x="344.3" width="22.1" height="11.6" style="stroke-opacity: 0.33; fill: rgb(179, 221, 202); fill-opacity: 0.33;" y="32.4" transform="matrix(0, -1, 1, 0, 693.309998, 510.269989)"></rect><polygon id="svg_4" class="cls-2" points="737.24 94.01 725.71 94.01 725.71 40 756.66 40 756.66 51.53 737.24 51.53 737.24 94.01" fill="#b3ddca"></polygon><polygon id="svg_5" class="cls-2" points="779.72 197.92 725.71 197.92 725.71 166.97 737.24 166.97 737.24 186.39 779.72 186.39 779.72 197.92" fill="#b3ddca"></polygon><polygon id="svg_6" class="cls-2" points="856.65 197.92 825.7 197.92 825.7 186.39 845.12 186.39 845.12 143.91 856.65 143.91 856.65 197.92" fill="#b3ddca"></polygon><polygon id="svg_7" class="cls-2" points="856.65 70.95 845.12 70.95 845.12 51.53 802.64 51.53 802.64 40 856.65 40 856.65 70.95" fill="#b3ddca"></polygon><path d="M 44.978 109.764 Q 39.008 112.918 30.109 112.918 Q 18.619 112.918 11.71 105.521 Q 4.801 98.124 4.801 86.108 Q 4.801 73.192 12.573 65.231 Q 20.346 57.271 32.286 57.271 Q 39.946 57.271 44.978 59.486 L 44.978 66.207 Q 39.195 62.978 32.211 62.978 Q 22.937 62.978 17.173 69.174 Q 11.409 75.369 11.409 85.733 Q 11.409 95.571 16.797 101.409 Q 22.186 107.248 30.935 107.248 Q 39.045 107.248 44.978 103.644 Z M 75.579 112.918 Q 64.127 112.918 57.237 105.371 Q 50.347 97.824 50.347 85.733 Q 50.347 72.741 57.368 65.006 Q 64.39 57.271 76.481 57.271 Q 87.633 57.271 94.448 64.781 Q 101.263 72.29 101.263 84.419 Q 101.263 97.598 94.279 105.258 Q 87.295 112.918 75.579 112.918 Z M 76.03 62.978 Q 67.544 62.978 62.25 69.099 Q 56.955 75.219 56.955 85.17 Q 56.955 95.12 62.118 101.184 Q 67.281 107.248 75.579 107.248 Q 84.441 107.248 89.548 101.466 Q 94.654 95.683 94.654 85.282 Q 94.654 74.618 89.698 68.798 Q 84.741 62.978 76.03 62.978 Z M 111.85 112.017 L 111.85 58.172 L 126.72 58.172 Q 155.182 58.172 155.182 84.419 Q 155.182 96.885 147.278 104.451 Q 139.374 112.017 126.119 112.017 Z M 118.159 63.879 L 118.159 106.31 L 126.194 106.31 Q 136.783 106.31 142.678 100.64 Q 148.573 94.97 148.573 84.569 Q 148.573 63.879 126.57 63.879 Z M 194.308 112.017 L 165.771 112.017 L 165.771 58.172 L 193.106 58.172 L 193.106 63.879 L 172.079 63.879 L 172.079 81.79 L 191.529 81.79 L 191.529 87.46 L 172.079 87.46 L 172.079 106.31 L 194.308 106.31 Z" transform="matrix(1.388561, 0, 0, 1.435642, 0.528885, 0.973957)" style="fill: rgb(255, 255, 255); white-space: pre;"></path><path d="M 215.902 93.468 L 215.902 112.017 L 203.774 112.017 L 203.774 58.172 L 222.774 58.172 Q 243.125 58.172 243.125 75.332 Q 243.125 83.442 237.286 88.455 Q 231.447 93.468 221.685 93.468 Z M 215.902 67.484 L 215.902 84.268 L 220.671 84.268 Q 230.358 84.268 230.358 75.782 Q 230.358 67.484 220.671 67.484 Z M 296.18 112.017 L 282.249 112.017 L 273.876 98.161 Q 272.937 96.584 272.073 95.345 Q 271.21 94.106 270.327 93.224 Q 269.445 92.341 268.488 91.872 Q 267.53 91.403 266.404 91.403 L 263.137 91.403 L 263.137 112.017 L 251.009 112.017 L 251.009 58.172 L 270.234 58.172 Q 289.834 58.172 289.834 72.816 Q 289.834 75.632 288.97 78.017 Q 288.107 80.401 286.53 82.316 Q 284.953 84.231 282.719 85.62 Q 280.484 87.009 277.743 87.798 L 277.743 87.948 Q 278.945 88.324 280.071 89.169 Q 281.198 90.013 282.249 91.14 Q 283.301 92.266 284.258 93.562 Q 285.216 94.857 286.004 96.096 Z M 263.137 67.259 L 263.137 82.241 L 268.394 82.241 Q 272.299 82.241 274.664 79.988 Q 277.067 77.697 277.067 74.318 Q 277.067 67.259 268.619 67.259 Z M 323.213 112.956 Q 311.648 112.956 304.364 105.427 Q 297.079 97.899 297.079 85.808 Q 297.079 73.041 304.476 65.156 Q 311.873 57.271 324.077 57.271 Q 335.604 57.271 342.72 64.818 Q 349.835 72.365 349.835 84.719 Q 349.835 97.411 342.457 105.183 Q 335.079 112.956 323.213 112.956 Z M 323.739 67.709 Q 317.355 67.709 313.601 72.497 Q 309.846 77.284 309.846 85.17 Q 309.846 93.167 313.601 97.824 Q 317.355 102.48 323.438 102.48 Q 329.709 102.48 333.389 97.955 Q 337.069 93.43 337.069 85.395 Q 337.069 77.021 333.501 72.365 Q 329.934 67.709 323.739 67.709 Z M 380.478 90.652 Q 380.478 101.466 375.465 107.211 Q 370.452 112.956 360.952 112.956 Q 356.709 112.956 353.104 111.491 L 353.104 100.114 Q 356.221 102.48 360.089 102.48 Q 368.387 102.48 368.387 90.164 L 368.387 58.172 L 380.478 58.172 Z M 424.559 112.017 L 392.267 112.017 L 392.267 58.172 L 423.32 58.172 L 423.32 68.047 L 404.395 68.047 L 404.395 80.025 L 422.006 80.025 L 422.006 89.863 L 404.395 89.863 L 404.395 102.179 L 424.559 102.179 Z M 471.796 110.102 Q 465.901 112.956 456.401 112.956 Q 444.01 112.956 436.913 105.671 Q 429.817 98.387 429.817 86.259 Q 429.817 73.342 437.796 65.306 Q 445.775 57.271 458.504 57.271 Q 466.389 57.271 471.796 59.261 L 471.796 70.939 Q 466.389 67.709 459.48 67.709 Q 451.895 67.709 447.239 72.478 Q 442.583 77.247 442.583 85.395 Q 442.583 93.205 446.977 97.842 Q 451.37 102.48 458.804 102.48 Q 465.901 102.48 471.796 99.025 Z M 518.992 68.047 L 503.634 68.047 L 503.634 112.017 L 491.469 112.017 L 491.469 68.047 L 476.186 68.047 L 476.186 58.172 L 518.992 58.172 Z" transform="matrix(1.388561, 0, 0, 1.435642, 0.528885, 0.973957)" style="fill: rgb(255, 255, 255); white-space: pre;"></path>
                </g>
                </svg>
               </a>

			</div>

			<div class="card mt-3">
				<div class="card-body">

					<div class="form-group d-flex text-nowrap">
						<label class="col-form-label text-end me-1">Service API URL</label>
						<input class="col-form-control form-control" type="text" id="serviceUrl" style="width:12.5rem"/>
						<label class="col-form-label text-end ms-3 me-1">Timeout</label>
						<input class="col-form-control form-control" type="number" id="serviceTimeoutSecTxt" style="width:4.5rem"/>
						<label class="col-form-label mx-1">sec</label>
						<label id="status" class="col-form-label rounded bg-white fw-bold ms-auto px-2"></label>
					</div>
				</div>
			</div>

			<form method="post" action="" enctype="multipart/form-data" id="myform">
				<div class="d-flex align-content-between mt-4">

					<div style="width:600px">

						<ul class="nav nav-tabs d-flex" id="DemoTabs" role="tablist">
							<li class="nav-item d-none" id="vision-tab-listitem">
								<button class="nav-link active" id="vision-tab" data-bs-toggle="tab" data-bs-target="#vision-panel" type="button" role="tab" aria-controls="vision" aria-selected="true">Vision</button>
							</li>
							<li class="nav-item d-none" id="image-tab-listitem">
								<button class="nav-link" id="image-tab" data-bs-toggle="tab" data-bs-target="#image-panel" type="button" role="tab" aria-controls="image" aria-selected="true">Image</button>
							</li>

							<li class="nav-item d-none" id="face-tab-listitem">
								<button class="nav-link" id="face-tab" data-bs-toggle="tab" data-bs-target="#face-panel" type="button" role="tab" aria-controls="face" aria-selected="false">Face</button>
							</li>
							<li class="nav-item d-none" id="text-tab-listitem">
								<button class="nav-link" id="text-tab" data-bs-toggle="tab" data-bs-target="#text-panel" type="button" role="tab" aria-controls="text" aria-selected="false">Text</button>
							</li>

							<li class="nav-item d-none" id="video-tab-listitem">
								<button class="nav-link" id="video-tab" data-bs-toggle="tab" data-bs-target="#video-panel" type="button" role="tab" aria-controls="video" aria-selected="false">Video</button>
							</li>

							<li class="nav-item d-none" id="train-tab-listitem">
								<button class="nav-link" id="train-tab" data-bs-toggle="tab" data-bs-target="#train-panel" type="button" role="tab" aria-controls="train" aria-selected="false">Train</button>
							</li>

							<li class="nav-item ms-auto" id="benchmark-tab-listitem">
								<button class="nav-link" id="benchmark-tab" data-bs-toggle="tab" data-bs-target="#benchmark-panel" type="button" role="tab" aria-controls="benchmark" aria-selected="false">Benchmark</button>
							</li>
						</ul>

						<div class="tab-content" id="DemoTabsContent">

							<div class="tab-pane fade show active" id="vision-panel" role="tabpanel" aria-labelledby="vision-tab">

								<div class="card mt-3 d-none objectdetection_queue">
									<div class="card-header h3">Object Detection</div>

									<div class="card-body">
										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="image" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Detect Objects"
												   style="width:11rem" id="things"
												   onclick="onDetectThings(image)" />
										</div>
									</div>

									<div class="card-body">

										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="customimage" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-warning" type="button" value="Custom Detect"
												   style="width:11rem" id="customthings"
												   onclick="onCustomDetect(customModel.value, customimage)" />
										</div>
										<div class="form-group d-flex justify-content-end mt-2">
											<label class="col-form-label col-2">Model</label>
											<select id="customModel" class="form-select" style="width:19rem">
												<option value="ipcam-general">General IP Cam</option>
												<option value="license-plate">License Plates v2</option>
												<option value="openlogo">Open Logo</option>
												<option value="actionnetv2">(Human) ActionNet v2</option>
											</select>
											<label style="width:11rem"></label>
										</div>
									</div>
								</div>

								<div class="card mt-3 d-none faceprocessing_queue">
									<div class="card-header h3">Face Detection</div>

									<div class="card-body">
										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="face_image" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Detect Faces"
												   style="width:11rem" id="face"
												   onclick="onDetectFaces(face_image)" />
										</div>
									</div>
								</div>

								<div class="card mt-3 d-none sceneclassifier_queue">
									<div class="card-header h3">Scene Classification</div>

									<div class="card-body">
										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="scene_image" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Classify Scene"
												   style="width:11rem" id="scene"
												   onclick="onDetectScene(scene_image)" />
										</div>
									</div>
								</div>

							</div>

							<div class="tab-pane fade show" id="image-panel" role="tabpanel" aria-labelledby="image-tab">

								<div class="card mt-3 d-none backgroundremover_queue">
									<div class="card-header h3">Background Removal</div>
									<div class="card-body">

										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="removeBgInput" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Remove Background"
												   style="width:11rem" id="on-removebg"
												   onclick="onRemoveBackground(removeBgInput, use_alphamatting.checked)" />
										</div>

										<div class="form-group row mt-1 justify-content-end">
											<div class="checkbox checkbox-primary col-4">
												<input id="use_alphamatting" class="styled" type="checkbox" checked>
												<label for="use_alphamatting">Use Alpha matting</label>
											</div>
										</div>
									</div>
								</div>

								<div class="card mt-3 d-none portraitfilter_queue">
									<div class="card-header h3">Background blurring</div>
									<div class="card-body">

										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="blurBgInput" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Blur Background" style="width:10rem"
												   id="on-blurbg" onclick="onBlurBackground(blurBgInput, strength.value)" />
										</div>

										<div class="form-group row mt-1 justify-content-end">
											<label class="col-3 col-form-label text-end">Blur Strength</label>
											<input class="form-control" id="strength" style="width:15rem"
												   type="range" min="0.0" max="1.0" step="0.1" value="1.0"
												   oninput="document.getElementById('strengthLabel').innerHTML=this.value;">
											<span id="strengthLabel" class="col-form-label text-nowrap col-1">1.0</span>
										</div>
									</div>
								</div>

								<div class="card mt-3 d-none cartooniser_queue">
									<div class="card-header h3">Cartoonise</div>
									<div class="card-body">

										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="cartoonInput" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Cartoonise" style="width:10rem"
												   id="on-cartoonise" onclick="onCartoonise(cartoonModel.value, cartoonInput, strength.value)" />
										</div>
										<div class="form-group d-flex justify-content-end mt-2">
											<label class="col-form-label col-2">Model</label>
											<select id="cartoonModel" class="form-select" style="width:19rem">
												<option value="face_paint_512_v1">face_paint v1</option>
												<option value="face_paint_512_v2">face_paint v2</option>
												<option value="celeba_distill">celeba_distill</option>
												<option value="paprika">Paprika</option>
											</select>
											<label style="width:11rem"></label>
										</div>

										<!--
										<div class="form-group row mt-1 justify-content-end">
											<label class="col-3 col-form-label text-end">Cartoonisation Strength</label>
											<input class="form-control" id="strength" style="width:15rem"
												type="range" min="0.0" max="1.0" step="0.1" value="1.0"
												oninput="document.getElementById('strengthLabel').innerHTML=this.value;">
											<span id="strengthLabel" class="col-form-label text-nowrap col-1">1.0</span>
										</div>
										-->
									</div>
								</div>

								<div class="card mt-3 d-none ocr_queue">
									<div class="card-header h3">Optical Character Recognition</div>
									<div class="card-body">

										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="ocrInput" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Read Text"
												   style="width:11rem" id="on-read-text"
												   onclick="onReadText(ocrInput)" />
										</div>

									</div>
								</div>

								<div class="card mt-3 d-none alpr_queue">
									<div class="card-header h3">License Plate reader</div>
									<div class="card-body">

										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="alprInput" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Read License Plates"
												   style="width:11rem" id="on-read-license"
												   onclick="onReadLicensePlate(alprInput, 0.4)" />
										</div>

									</div>
								</div>

								<div class="card mt-3 d-none superresolution_queue">
									<div class="card-header h3">Increase Resolution</div>
									<div class="card-body">

										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="superResInput" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Super Resolution"
												   style="width:11rem" id="superresolution"
												   onclick="onSuperResolution(superResInput)" />
										</div>
									</div>
								</div>

							</div>

							<div class="tab-pane fade show" id="face-panel" role="tabpanel" aria-labelledby="face-tab">

								<div class="card mt-3 d-none faceprocessing_queue">
									<div class="card-header h3">Face Comparison</div>
									<div class="card-body">
										<div class="d-flex align-items-center">
											<div class="w-75">
												<div class="form-group row">
													<label class="col-form-label col-3">Image 1</label>
													<input class="col form-control btn-light" id="face1" type="file" onchange="return previewImage(this)" />
												</div>
												<div class="form-group row">
													<label class="col-form-label col-3">Image 2</label>
													<input class="col form-control btn-light" id="face2" type="file" onchange="return previewImage(this)" />
												</div>
											</div>
											<div style="width:10rem" class="text-end">
												<input type="button" value="Compare" class="btn btn-success" onclick="onCompareFaces(face1, face2)" />
											</div>
										</div>
									</div>
								</div>

								<div class="card mt-3 d-none faceprocessing_queue">
									<div class="card-header h3">Face Registration</div>
									<div class="card-body">

										<div>
											<div class="form-group row">
												<label class="col-form-label col-4">1. Person's name</label>
												<input class="form-control" style="width:12rem" id="userId" type="text"
													   placeholder="Enter name" />
											</div>
											<div class="form-group row my-3">
												<label class="col-form-label col-4">2. Select images</label>
												<input class="btn-light col form-control" style="width:8rem" id="faces" multiple="multiple" type="file" />
											</div>
											<div class="form-group row">
												<label class="col-form-label col-4">3. Final step</label>
												<input class="form-control btn-success" style="width:12rem;" id="register" type="button"
													   value="Register Faces" onclick="onRegisterFaces(userId.value, faces)" />
											</div>
										</div>

										<div class="mt-4 text-center">
											<input style="width:12rem" id="listfaces" type="button" class="btn  btn-primary ml-3``"
												   value="List Registered Faces" onclick="onListRegisteredFaces()" />
											<input style="width:12rem;" class="btn btn-danger" id="deleteFaces" type="button"
												   value="Delete Person's Images" onclick="onDeleteFace(userId.value)" />
										</div>

									</div>
								</div>

								<div class="card mt-3 d-none faceprocessing_queue">
									<div class="card-header h3">Face Recognition</div>
									<div class="card-body">

										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="faceInput" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
											<input class="form-control btn-success" type="button" value="Recognise" style="width:7rem"
												   id="recognise" onclick="onRecogniseFace(faceInput, minRecogConfidence.value)" />
										</div>

										<div class="form-group row mt-1">
											<label class="col-7 col-form-label text-end">Minimum Recognition Confidence</label>
											<input class="form-control" value="0.6" id="minRecogConfidence" type="text"
												   style="width:5rem" />
										</div>
									</div>
								</div>

							</div>

							<div class="tab-pane fade show" id="text-panel" role="tabpanel" aria-labelledby="text-tab">

								<div class="card mt-3 d-none textsummary_queue">
									<div class="card-header h3">Text Summary</div>
									<div class="card-body">

										<div class="form-group mt-1">
											<textarea id="articleText" class="w-100" style="height:200px"></textarea>
										</div>

										<div class="form-group row mt-1">
											<div class="col-2">
												<input class="btn-success col-form-label" type="button" value="Summarize"
													   id="summarize" onclick="onSummarizeText(articleText.value, numSentences.value)" />
											</div>

											<label class="col-5 col-form-label text-end">Sentences to produce</label>
											<input class="form-control" value="2" id="numSentences" type="number"
												   style="width:5rem" />
										</div>
									</div>

								</div>

								<div class="card mt-3 d-none sentimentanalysis_queue">
									<div class="card-header h3">Sentiment Analysis</div>
									<div class="card-body">

										<div class="form-group mt-1">
											<textarea id="sentimentText" class="w-100" style="height:200px"></textarea>
										</div>

										<div class="form-group row mt-1">
											<div class="col-2">
												<input class="btn-success col-form-label" type="button" value="Sentiment"
													   id="sentiment" onclick="onAnalyzeSentiment(sentimentText.value)" />
											</div>
										</div>
									</div>

								</div>

							</div>

							<div class="tab-pane fade show" id="video-panel" role="tabpanel" aria-labelledby="video-tab">

								<div class="card mt-3 d-none faceprocessing_queue objectdetection_queue">

									<div class="d-flex justify-content-between">
										<input class="btn btn-success" type="button" value="Start"
											   onclick="onStartVideo()" style="width:5rem">
										<input class="btn btn-secondary me-auto" type="button" value="Stop"
											   onclick="onStopVideo()" style="width:5rem">
										<!--
										<input class="btn btn-light" id="videoInput" type="file" style="width:10rem"
											onchange="return loadVideoFile(this)" />
										-->
									</div>
									<video id="video" style="width:100%;height:480px;display:none" autoplay></video>
									<canvas id="canvas"></canvas>

								</div>
							</div>

							<div class="tab-pane fade show" id="train-panel" role="tabpanel" aria-labelledby="train-tab">

								<div class="card mt-3 d-none trainingyolov5_queue">
									<div class="card-header h3">YoloV5 Object Detection Training</div>

									<div class="card-body">
										<div class="row g-3">
											<div class="col-2">
												<h6 class="card-title fw-bold">Dataset</h6>
											</div>
											<div class="col-10">
												<div class="progress mt-0 bg-transparent" style="height: 20px;">
													<div id="datasetProgress" class="progress-bar bg-success" role="progressbar"
														 aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"></div>
												</div>
											</div>											
										</div>
										
										<div class="row g-3">
											<div class="col-2">
												<label class="col-form-label">Name</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingInputDatasetName" 
													   data-bs-toggle="tooltip" type="text"
													   title="Name of Dataset to create." onchange="onDatasetNameChange()" />
											</div>
											<div class="col-2">
												<label class="col-form-label">#Images</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingNumImages" type="number" 
													   data-bs-toggle="tooltip" title="Number of images to use for training (10 - 10,000)" 
													   value="100" />
											</div>
										</div>
										<div class="row g-3">
											<div class="col-2">
												<label class="col-form-label text-nowrap">
													Classes
													<div class='dropdown text-wrap d-inline-block'>
														<button class='btn btn-sm dropdown d-inline border-none' type='button' id='open-images-classes-label' 
																data-bs-toggle='dropdown'>
															<svg fill="#000000" height="20px" width="20px" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
																viewBox="0 0 330 330" xml:space="preserve">
																<g>
																<path d="M165,0C74.019,0,0,74.02,0,165.001C0,255.982,74.019,330,165,330s165-74.018,165-164.999C330,74.02,255.981,0,165,0z M165,300c-74.44,0-135-60.56-135-134.999C30,90.562,90.56,30,165,30s135,60.562,135,135.001C300,239.44,239.439,300,165,300z"/>
																<path d="M164.998,70c-11.026,0-19.996,8.976-19.996,20.009c0,11.023,8.97,19.991,19.996,19.991 c11.026,0,19.996-8.968,19.996-19.991C184.994,78.976,176.024,70,164.998,70z"/>
																<path d="M165,140c-8.284,0-15,6.716-15,15v90c0,8.284,6.716,15,15,15c8.284,0,15-6.716,15-15v-90C180,146.716,173.284,140,165,140z"/>
																</g>
															</svg>																
														</button>
														<ul class='dropdown-menu' aria-labelledby="open-images-classes-label">
															<li>
																<!-- TODO: Pull this from the training module -->
																<div id='open-images-classes' style="width:60rem">
																	Accordion, Adhesive tape, Aircraft, Airplane, Alarm clock, Alpaca, Ambulance, Animal, Ant, Antelope,
																	Apple, Armadillo, Artichoke, Auto part, Axe, Backpack, Bagel, Baked goods, Balance beam, Ball, Balloon,
																	Banana, Band-aid, Banjo, Barge, Barrel, Baseball bat, Baseball glove, Bat (Animal), Bathroom accessory,
																	Bathroom cabinet, Bathtub, Beaker, Bear, Bed, Bee, Beehive, Beer, Beetle, Bell pepper, Belt, Bench,
																	Bicycle, Bicycle helmet, Bicycle wheel, Bidet, Billboard, Billiard table, Binoculars, Bird, Blender,
																	Blue jay, Boat, Bomb, Book, Bookcase, Boot, Bottle, Bottle opener, Bow and arrow, Bowl, Bowling equipment,
																	Box, Boy, Brassiere, Bread, Briefcase, Broccoli, Bronze sculpture, Brown bear, Building, Bull, Burrito,
																	Bus, Bust, Butterfly, Cabbage, Cabinetry, Cake, Cake stand, Calculator, Camel, Camera, Can opener,
																	Canary, Candle, Candy, Cannon, Canoe, Cantaloupe, Car, Carnivore, Carrot, Cart, Cassette deck, Castle,
																	Cat, Cat furniture, Caterpillar, Candy, Cannon, Canoe, Cantaloupe, Car, Carnivore, Carrot, Cart,
																	Cassette deck, Castle, Cat, Cat furniture, Caterpillar, Cattle, Ceiling fan, Cello, Centipede, Chainsaw,
																	Chair, Cheese, Cheetah, Chest of drawers, Chicken, Chime, Chisel, Chopsticks, Christmas tree, Clock,
																	Closet, Clothing, Coat, Cocktail, Cocktail shaker, Coconut, Coffee, Coffee cup, Coffee table, Coffeemaker,
																	Coin, Common fig, Common sunflower, Computer keyboard, Computer monitor, Computer mouse, Container,
																	Convenience store, Cookie, Cooking spray, Corded phone, Cosmetics, Couch, Countertop, Cowboy hat, Crab,
																	Cream, Cricket ball, Crocodile, Croissant, Crown, Crutch, Cucumber, Cupboard, Curtain, Cutting board,
																	Dairy Product, Deer, Desk, Dessert, Diaper, Dice, Digital clock, Dinosaur, Dishwasher, Dog, Dog bed,
																	Doll, Dolphin, Door, Door handle, Doughnut, Dragonfly, Drawer, Dress, Drill (Tool), Drink, Drinking straw,
																	Drum, Duck, Dumbbell, Eagle, Earrings, Egg (Food), Elephant, Envelope, Eraser, Face powder, Facial tissue holder,
																	Falcon, Fashion accessory, Fast food, Fax, Fedora, Filing cabinet, Fire hydrant, Fireplace, Fish, Flag,
																	Flashlight, Flower, Flowerpot, Flute, Flying disc, Food, Football, Football helmet, Footwear, Fork,
																	Fountain, Fox, French fries, French horn, Frog, Fruit, Frying pan, Furniture, Garden Asparagus,
																	Gas stove, Giraffe, Girl, Glasses, Glove, Goat, Goggles, Goldfish, Golf ball, Golf cart, Gondola,
																	Goose, Grape, Grapefruit, Grinder, Guacamole, Guitar, Hair dryer, Hair spray, Hamburger, Hammer,
																	Hamster, Hand dryer, Handbag, Handgun, Harbor seal, Harmonica, Harp, Harpsichord, Hat, Headphones,
																	Heater, Hedgehog, Helicopter, Helmet, High heels, Hiking equipment, Hippopotamus, Home appliance,
																	Honeycomb, Horizontal bar, Horse, Hot dog, House, Houseplant, Human arm, Human beard, Human body,
																	Human ear, Human eye, Human face, Human foot, Human hair, Human hand, Human head, Human leg, Human mouth,
																	Human nose, Humidifier, Ice cream, Indoor rower, Insect, Invertebrate, Ipod, Isopod, Jacket, Jacuzzi,
																	Jaguar (Animal), Jeans, Jellyfish, Jet ski, Jug, Juice, Kangaroo, Kettle, Kitchen & dining room table,
																	Kitchen appliance, Kitchen knife, Kitchen utensil, Kitchenware, Kite, Knife, Koala, Ladder, Ladle,
																	Ladybug, Lamp, Land vehicle, Lantern, Laptop, Lavender (Plant), Lemon, Leopard, Light bulb, Light switch,
																	Lighthouse, Lily, Limousine, Lion, Lipstick, Lizard, Lobster, Loveseat, Luggage and bags, Lynx, Magpie,
																	Mammal, Man, Mango, Maple, Maracas, Marine invertebrates, Marine mammal, Measuring cup, Mechanical fan,
																	Medical equipment, Microphone, Microwave oven, Milk, Miniskirt, Mirror, Missile, Mixer, Mixing bowl,
																	Mobile phone, Monkey, Moths and butterflies, Motorcycle, Mouse, Muffin, Mug, Mule, Mushroom,
																	Musical instrument, Musical keyboard, Necklace, Nightstand, Oboe, Office building, Office supplies,
																	Orange, Organ (Musical Instrument), Ostrich, Otter, Oven, Owl, Oyster, Paddle, Palm tree, Pancake,
																	Panda, Paper cutter, Paper towel, Parachute, Parking meter, Parrot, Pasta, Pastry, Peach, Pear, Pen,
																	Pencil case, Pencil sharpener, Penguin, Perfume, Person, Personal care, Personal flotation device,
																	Piano, Picnic basket, Picture frame, Pig, Pillow, Pineapple, Pitcher (Container), Pizza, Pizza cutter,
																	Plant, Plastic bag, Plate, Platter, Plumbing fixture, Polar bear, Pomegranate, Popcorn, Porch, Porcupine,
																	Poster, Potato, Power plugs and sockets, Pressure cooker, Pretzel, Printer, Pumpkin, Punching bag,
																	Rabbit, Raccoon, Racket, Radish, Ratchet (Device), Raven, Rays and skates, Red panda, Refrigerator,
																	Remote control, Reptile, Rhinoceros, Rifle, Ring binder, Roller skates, Rose, Rugby ball, Ruler, Salad,
																	Salt and pepper shakers, Sandal, Sandwich, Saucer, Saxophone, Scale, Scarf, Scissors, Scoreboard,
																	Scorpion, Screwdriver, Sculpture, Sea lion, Sea turtle, Seafood, Seahorse, Seat belt, Segway,
																	Serving tray, Sewing machine, Shark, Sheep, Shelf, Shellfish, Shirt, Shorts, Shotgun, Shower, Shrimp,
																	Sink, Skateboard, Ski, Skirt, Skull, Skunk, Skyscraper, Slow cooker, Snack, Snail, Snake, Snowboard,
																	Snowman, Snowmobile, Snowplow, Soap dispenser, Sock, Sofa bed, Sombrero, Sparrow, Spatula, Spice rack,
																	Spider, Spoon, Sports equipment, Sports uniform, Squash (Plant), Squid, Squirrel, Stairs, Stapler,
																	Starfish, Stationary bicycle, Stethoscope, Stool, Stop sign, Strawberry, Street light, Stretcher,
																	Studio couch, Submarine sandwich, Suit, Suitcase, Sun hat, Sunglasses, Surfboard, Sushi, Swan, Swim cap,
																	Swimming pool, Swimwear, Sword, Syringe, Table, Table tennis racket, Tablet computer, Tableware, Taco,
																	Tank, Tap, Tart, Taxi, Tea, Teapot, Teddy bear, Telephone, Television, Tennis ball, Tennis racket,
																	Tent, Tiara, Tick, Tie, Tiger, Tin can, Tire, Toaster, Toilet, Toilet paper, Tomato, Tool, Toothbrush,
																	Torch, Tortoise, Towel, Tower, Toy, Traffic light, Traffic sign, Train, Training bench, Treadmill,
																	Tree, Tree house, Tripod, Trombone, Trousers, Truck, Trumpet, Turkey, Turtle, Umbrella, Unicycle, Van,
																	Vase, Vegetable, Vehicle, Vehicle registration plate, Violin, Volleyball (Ball), Waffle, Waffle iron,
																	Wall clock, Wardrobe, Waste container, Watch, Watercraft, Watermelon, Weapon, Whale, Wheel, Wheelchair,
																	Whisk, Whiteboard, Willow, Window, Window blind, Wine, Wine glass, Wine rack, Winter melon, Wok, Woman,
																	Wood-burning stove, Woodpecker, Worm, Wrench, Zebra, Zucchini
																</div>
															</li>
														</ul>
													</div>
												</label>
											</div>
											<div class="col-10">
												<input class="form-control" id="trainingDatasetClasses" type="text" 
													   data-bs-toggle="tooltip" title="A comma separated list of classes. Click the info button for a list." />
											</div>
										</div>
										<div class="row g-3">
											<div class="col-2">
											</div>
											<div class="col-10 d-flex justify-content-around">
												<div>
													<input class="btn btn-success" type="button" value="Create Dataset"
														   onclick="onDatasetCreate(
																trainingInputDatasetName.value,
																trainingDatasetClasses.value,
																trainingNumImages.value)">
												</div>
												<div>
													<input class="btn btn-info" type="button" value="Dataset Info"
														   onclick="onTrainingDatasetInfo(trainingInputDatasetName.value)">
												</div>
											</div>
										</div>

										<div class="row g-3 mt-3">
											<div class="col-2">
												<h6 class="card-title fw-bold">Model</h6>
											</div>
											<div class="col-10">
												<div class="progress mt-0 bg-transparent" style="height: 20px;">
													<div id="trainingProgress" class="progress-bar bg-success" role="progressbar"
														 aria-valuemin="0" aria-valuemax="100" aria-valuenow="0"></div>
												</div>
											</div>											
										</div>

										<div class="row g-3">
											<div class="col-2">
												<label class="col-form-label">Name</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingInputModelName" type="text"
													   data-bs-toggle="tooltip" title="Name of YoloV5 Model to train." />
											</div>
											<div class="col-2">
												<label class="col-form-label">Dataset</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingInputModelDatasetName" type="text"
													   data-bs-toggle="tooltip" 
													   title="Name of Dataset used to train the Model. Enter the name of the dataset you created above or the full path of a dataset you have created by other means." />
											</div>
										</div>

										<div class="row g-3">
											<div class="col-2">
												<label class="col-form-label">Model size</label>
											</div>
											<div class="col-4">
												<select class="form-select" id="trainingModelSize" 
														data-bs-toggle="tooltip" title="The size of the YoloV5 Model to create.">
													<option value="tiny">Tiny</option>
													<option value="small" selected>Small</option>
													<option value="medium">Medium</option>
													<option value="large">Large</option>
												</select>
											</div>
											<div class="col-2">
												<label class="col-form-label">Tuning</label>
											</div>
											<div class="col-4">
												<select class="form-select" id="trainingModelHyp" data-bs-toggle="tooltip"
														title="Select which Hyper Parameters file to use when training.">
													<option value="fine" selected>Fine</option>
													<option value="low">Low</option>
													<option value="medium">Medium</option>
													<option value="high">High</option>
												</select>
											</div>
										</div>

										<div class="row g-3">
											<div class="col-2">
												<label class="col-form-label">Batch</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingBatchSize" type="number" 
													   value="4" min="-1" max="256"
													   data-bs-toggle="tooltip" title="Number of images in each training batch. Higher = more memory use but better performance. Use -1 to auto select (experimental)." />
											</div>
											<div class="col-2">
												<label class="col-form-label">Epochs</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingNumEpochs" type="number" value="100"
													   data-bs-toggle="tooltip"
													   title="Number of Epochs to train. Higher = better, but can lead to overtraining. (10 - 1,000)"  />
											</div>
										</div>

										<div class="row g-3">
											<div class="col-2">
												<label class="col-form-label">Patience</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingPatience" type="number" value="100" 
													   data-bs-toggle="tooltip" title="Number of epochs to wait for no observable improvement for early stopping of training." />
											</div>
											<div class="col-2">
												<label class="col-form-label">Workers</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingWorkers" type="number" value="-1"
													   data-bs-toggle="tooltip"
													   title="Number of number of worker threads. -1=default, 0 for Windows, 2 for Linux."/>
											</div>
										</div>

										<div class="row g-3">
											<div class="col-2">
												<label class="col-form-label">Freeze</label>
											</div>
											<div class="col-4">
												<select class="form-select" id="trainingFreeze" data-bs-toggle="tooltip"
														title="Which layers of the model weights to exclude from training. The more exlcuded, the faster the training, at the cost of accuracy">
													<option value="0">None</option>
													<option value="10" selected>Backbone</option>
													<option value="24">All</option>
												</select>
											</div>
											<div class="col-2">
												<label class="col-form-label">Device</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingDevice" data-bs-toggle="tooltip"
													   type="text" value="0" 
													   title="'', 'cpu', '0' or '0,1,2,3' for multiple GPUs." />
											</div>
										</div>

										<div class="row g-3 pt-2">
											<div class="col-2">
											</div>
											<div class="col-10 d-flex justify-content-around">
												<div>
													<input class="btn btn-success" type="button" value="Train Model"
														   onclick="onTrainingStart(
																trainingInputModelName.value,
																trainingInputModelDatasetName.value,
																trainingModelSize.value,
																trainingNumEpochs.value,
																trainingBatchSize.value,
																trainingDevice.value,
																trainingFreeze.value,
																trainingModelHyp.value,
																trainingPatience.value,
																trainingWorkers.value
															)">
												</div>
												<div>
													<input class="btn btn-success" type="button" value="Resume Training"
														   data-bs-toggle="tooltip"
														   title="Resume training the YoloV5 Model from the last successful epoch with the parameters specified when it was started."
														   onclick="onTrainingResumeTraining(trainingInputModelName.value)">
												</div>
												<div>
													<input class="btn btn-info" type="button" value="Model Info"
														   onclick="onTrainingModelInfo(trainingInputModelName.value)">
												</div>
											</div>
										</div>

										<div class="row g-3 mt-4">
											<div class="col-2">
												<label class="col-form-label">Status</label>
											</div>
											<div class="col-10">
												<input class="form-control" id="statusMessage" type="text" readonly 
													   title="The status of the last started long running action."/>
											</div>
										</div>
										<div class="row g-3">
											<div class="col-2">
												<label class="col-form-label">Action</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingAction"
													   type="text" readonly />
											</div>
											<div class="col-2">
												<label class="col-form-label">State</label>
											</div>
											<div class="col-4">
												<input class="form-control" id="trainingState" 
													   type="text" readonly />
											</div>
										</div>
                                        <div class="row g-3">
                                            <div class="col-2">
                                                <label class="col-form-label">Model</label>
                                            </div>
                                            <div class="col-4">
                                                <input class="form-control" id="trainingModelName" 
                                                       type="text" readonly />
                                            </div>
                                            <div class="col-2">
                                                <label class="col-form-label">Dataset</label>
                                            </div>
                                            <div class="col-4">
                                                <input class="form-control" id="trainingDatasetName"
                                                       type="text" readonly />
                                            </div>
                                        </div>

										<div class="row g-3 pt-2">
											<div class="col-12 text-center">
												<input class="btn btn-danger" type="button" value="Cancel"
													   id="trainingCancelBtn"
													   disabled hidden 
													   onclick="onTrainingCancel()">
											</div>
										</div>
									</div>
								</div>
							</div>


							<div class="tab-pane fade show" id="benchmark-panel" role="tabpanel" aria-labelledby="benchmark-tab">

								<div class="card mt-3 objectdetection_queue">
									<div class="card-header h3">Benchmark</div>
									<div class="card-body">

										<div class="form-group row">
											<label class="col-form-label col-2">Image</label>
											<input class="col form-control btn-light" id="benchmarkInput" type="file" style="width:17rem"
												   onchange="return previewImage(this)" />
										</div>
										<div class="form-group d-flex justify-content-end mt-2">
											<select id="benchmarkModel" class="form-select me-5">
												<option value="">Standard model</option>
												<option value="round-trip">No inference: round-trip speed test only</option>
												<option value="ipcam-general">General IP Cam</option>
												<option value="license-plate">License Plates v2</option>
												<option value="openlogo">Open Logo</option>
												<option value="actionnetv2">(Human) ActionNet v2</option>
											</select>
											<input class="form-control btn-success" type="button" value="Go" style="width:7rem"
												   id="on-benchmark" onclick="onBenchmark(benchmarkInput, benchmarkModel.value, benchmarkResult)" />

											<!-- See note above on how this button isn't currently that useful
					<input type="button" value="Stop" class="styleD" style="margin-left:1em"
										 onclick="isBenchmarkCancelled = true;" />
					-->
										</div>
										<div class="form-group row mt-1">
											<span id="benchmarkResult"></span>
										</div>
									</div>
								</div>

							</div>

						</div>

					</div>

					<div class="ms-4 mt-3 position-sticky" style="width:475px;">
						<div id="result" class="w-100 mb-4 bg-white border-1 border-light p-1 text-black rounded"
							 style="height: 195px; overflow-y: auto;"></div>

						<div class="w-100 position-relative border-1 border-light mb-4 ">

							<canvas id="annotations" class="position-absolute"
									style="left:0;top:0;pointer-events:none;z-index:10"></canvas>

							<div id="imageMask" class="position-absolute"
								 style="left:0;top:0;pointer-events:none;z-index:10"></div>

							<img src="" id="img" class="w-100" style="height:250px;visibility:hidden">
						</div>
						<div class="w-100 position-relative border-1 border-light">
							<img src="" id="img2" class="w-100" style="height:250px;visibility:hidden">
						</div>

					</div>
				</div>
			</form>
		</div>
	</div>

	<script src="assets/bootstrap.bundle.min.js"></script>
	<script>
		let triggerTabList = [].slice.call(document.querySelectorAll('#DemoTabs button'))
		triggerTabList.forEach(function (triggerEl) {
			let tabTrigger = new bootstrap.Tab(triggerEl)

			triggerEl.addEventListener('click', function (event) {
				event.preventDefault()
				tabTrigger.show()
			})
		})

        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })
	</script>

</body>
</html>